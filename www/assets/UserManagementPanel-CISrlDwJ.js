import{b as p,c as F,A as L,f as n,g as t,k,v as I,L as C,l as c,t as g,F as z,D as E,o as r,G as M}from"./vendor-C5FfeEaS.js";import{_ as G,a as O}from"./index-CmUZZITA.js";import"./router-Cvbgimde.js";const j={name:"UserManagementPanel",emits:["close"],setup(P,{emit:o}){const u=O(),e=p([]),f=p(""),_=p(""),s=p(""),d=p(1),b=p(!1),y=p(null),S=F(()=>u.loading),T=F(()=>u.error),m=async()=>{const a=await u.getUserManagementList({searchTerm:f.value.trim(),roleFilter:_.value||null,statusFilter:s.value||null,limit:20,offset:(d.value-1)*20});a.success&&(e.value=a.data.users||[],b.value=a.data.has_more||!1)},U=()=>{d.value=1,m()},w=()=>{y.value&&clearTimeout(y.value),y.value=setTimeout(()=>{U()},300)},A=async(a,i)=>{const v=`Are you sure you want to promote ${a.username||a.email} to ${i}?`;if(!confirm(v))return;let l;i==="moderator"?l=await u.promoteToModerator(a.id,`Promoted to ${i}`):i==="admin"&&(l=await u.promoteToAdmin(a.id,{},`Promoted to ${i}`)),l.success?await m():alert(l.error||"Failed to promote user")},x=async a=>{const i=`Are you sure you want to demote ${a.username||a.email} to regular user?`;if(!confirm(i))return;const v=prompt("Please provide a reason for demotion:");if(!v)return;const l=await u.demoteToUser(a.id,v);l.success?await m():alert(l.error||"Failed to demote user")},D=async a=>{const i=prompt("Please provide a reason for suspension:");if(!i)return;const v=prompt("Duration in days (leave empty for indefinite):"),l=v?parseInt(v):null,h=await u.suspendUser(a.id,i,l);h.success?await m():alert(h.error||"Failed to suspend user")},N=async a=>{const i=`Are you sure you want to reactivate ${a.username||a.email}?`;if(!confirm(i))return;const v=prompt("Optional notes for reactivation:")||"",l=await u.reactivateUser(a.id,v);l.success?await m():alert(l.error||"Failed to reactivate user")},V=()=>{d.value>1&&(d.value--,m())},B=()=>{b.value&&(d.value++,m())};return L(()=>{m()}),{users:e,searchTerm:f,roleFilter:_,statusFilter:s,currentPage:d,hasMore:b,loading:S,error:T,loadUsers:m,applyFilters:U,debouncedSearch:w,promoteUser:A,demoteUser:x,suspendUser:D,reactivateUser:N,previousPage:V,nextPage:B}}},q={class:"user-management-panel"},H={class:"panel-header"},J={class:"search-bar"},K={class:"filters"},Q={key:0,class:"loading-state"},W={key:1,class:"error-state"},X={class:"error-message"},Y={key:2,class:"empty-state"},Z={key:3,class:"users-list"},R={class:"user-info"},$={class:"user-details"},ee={class:"username"},se={class:"email"},te={class:"user-meta"},oe={class:"reputation"},ae={class:"user-actions"},ne=["onClick","disabled"],re=["onClick","disabled"],ie=["onClick","disabled"],le=["onClick","disabled"],de=["onClick","disabled"],ce={key:4,class:"pagination"},ue=["disabled"],me={class:"page-info"},ve=["disabled"];function pe(P,o,u,e,f,_){return r(),n("div",q,[t("div",H,[o[9]||(o[9]=t("h3",null,"User Management",-1)),t("div",J,[k(t("input",{"onUpdate:modelValue":o[0]||(o[0]=s=>e.searchTerm=s),type:"text",placeholder:"Search users...",class:"search-input",onInput:o[1]||(o[1]=(...s)=>e.debouncedSearch&&e.debouncedSearch(...s))},null,544),[[I,e.searchTerm]])])]),t("div",K,[k(t("select",{"onUpdate:modelValue":o[2]||(o[2]=s=>e.roleFilter=s),onChange:o[3]||(o[3]=(...s)=>e.applyFilters&&e.applyFilters(...s)),class:"filter-select"},o[10]||(o[10]=[t("option",{value:""},"All Roles",-1),t("option",{value:"user"},"Users",-1),t("option",{value:"moderator"},"Moderators",-1),t("option",{value:"admin"},"Admins",-1)]),544),[[C,e.roleFilter]]),k(t("select",{"onUpdate:modelValue":o[4]||(o[4]=s=>e.statusFilter=s),onChange:o[5]||(o[5]=(...s)=>e.applyFilters&&e.applyFilters(...s)),class:"filter-select"},o[11]||(o[11]=[t("option",{value:""},"All Status",-1),t("option",{value:"active"},"Active",-1),t("option",{value:"suspended"},"Suspended",-1),t("option",{value:"banned"},"Banned",-1)]),544),[[C,e.statusFilter]])]),e.loading?(r(),n("div",Q,o[12]||(o[12]=[t("div",{class:"loading-spinner"},null,-1),t("p",null,"Loading users...",-1)]))):c("",!0),e.error?(r(),n("div",W,[t("p",X,g(e.error),1),t("button",{onClick:o[6]||(o[6]=(...s)=>e.loadUsers&&e.loadUsers(...s)),class:"retry-btn"},"Retry")])):c("",!0),!e.loading&&!e.error&&e.users.length===0?(r(),n("div",Y,o[13]||(o[13]=[t("p",null,"No users found matching your criteria.",-1)]))):c("",!0),!e.loading&&!e.error&&e.users.length>0?(r(),n("div",Z,[(r(!0),n(z,null,E(e.users,s=>(r(),n("div",{key:s.id,class:"user-item"},[t("div",R,[t("div",$,[t("span",ee,g(s.username||"No username"),1),t("span",se,g(s.email),1)]),t("div",te,[t("span",{class:M(["role-badge",s.role])},g(s.role),3),t("span",{class:M(["status-badge",s.account_status])},g(s.account_status),3),t("span",oe,g(s.reputation_score)+" rep",1)])]),t("div",ae,[s.role==="user"?(r(),n("button",{key:0,onClick:d=>e.promoteUser(s,"moderator"),class:"action-btn promote",disabled:e.loading}," Make Moderator ",8,ne)):c("",!0),s.role==="moderator"?(r(),n("button",{key:1,onClick:d=>e.promoteUser(s,"admin"),class:"action-btn promote",disabled:e.loading}," Make Admin ",8,re)):c("",!0),s.role!=="user"?(r(),n("button",{key:2,onClick:d=>e.demoteUser(s),class:"action-btn demote",disabled:e.loading}," Demote ",8,ie)):c("",!0),s.account_status==="active"?(r(),n("button",{key:3,onClick:d=>e.suspendUser(s),class:"action-btn suspend",disabled:e.loading}," Suspend ",8,le)):c("",!0),s.account_status==="suspended"?(r(),n("button",{key:4,onClick:d=>e.reactivateUser(s),class:"action-btn reactivate",disabled:e.loading}," Reactivate ",8,de)):c("",!0)])]))),128))])):c("",!0),e.users.length>0?(r(),n("div",ce,[t("button",{onClick:o[7]||(o[7]=(...s)=>e.previousPage&&e.previousPage(...s)),disabled:e.currentPage===1||e.loading,class:"page-btn"}," Previous ",8,ue),t("span",me,"Page "+g(e.currentPage),1),t("button",{onClick:o[8]||(o[8]=(...s)=>e.nextPage&&e.nextPage(...s)),disabled:!e.hasMore||e.loading,class:"page-btn"}," Next ",8,ve)])):c("",!0)])}const be=G(j,[["render",pe],["__scopeId","data-v-ce8fc444"]]);export{be as default};
