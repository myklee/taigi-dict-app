import{_ as k,s as l}from"./index-CmUZZITA.js";import{b as s,o as c,f as u,g as b,l as p}from"./vendor-C5FfeEaS.js";const U={props:{wordId:{type:Number,required:!0},mknoll:{type:Boolean}},setup(e){const o=s(null),n=s([]),r=s(!1),t=s(null);return{startRecording:async()=>{try{const i=await navigator.mediaDevices.getUserMedia({audio:!0});o.value=new MediaRecorder(i),o.value.ondataavailable=d=>{n.value.push(d.data)},o.value.onstop=()=>{const d=new Blob(n.value,{type:"audio/webm"});t.value=URL.createObjectURL(d)},o.value.start(),r.value=!0}catch(i){console.error("Error accessing microphone:",i),alert("Microphone access is required for recording.")}},stopRecording:()=>{o.value&&o.value.state!=="inactive"&&(o.value.stop(),r.value=!1)},uploadAudio:async()=>{if(!t.value)return;const d=await(await fetch(t.value)).blob(),f=`audio-${e.wordId}-${Date.now()}.webm`;try{const{data:g,error:R}=await l.storage.from("audio-files").upload(f,d);if(R){console.error("Error uploading audio:",R),alert("Failed to upload audio.");return}const w=l.storage.from("audio-files").getPublicUrl(f).data.publicUrl;if(e.mknoll){const{error:m}=await l.from("maryknoll").update({audio_url:w}).eq("id",e.wordId);m?console.error("Error saving audio URL to database:",m):alert(`Audio uploaded successfully for word ID ${e.wordId}`)}else alert("didnt work"),console.log(e.wordId)}catch(g){console.error("Error uploading audio:",g)}},isRecording:r,audioURL:t}}},y={class:"audio-recorder"},_=["disabled"],A=["disabled"],L=["src"];function E(e,o,n,r,t,v){return c(),u("div",y,[o[3]||(o[3]=b("h1",null,"Audio Recorder",-1)),b("button",{onClick:o[0]||(o[0]=(...a)=>r.startRecording&&r.startRecording(...a)),disabled:r.isRecording}," Start Recording ",8,_),b("button",{onClick:o[1]||(o[1]=(...a)=>r.stopRecording&&r.stopRecording(...a)),disabled:!r.isRecording}," Stop Recording ",8,A),r.audioURL?(c(),u("audio",{key:0,src:r.audioURL,controls:""},null,8,L)):p("",!0),r.audioURL?(c(),u("button",{key:1,onClick:o[2]||(o[2]=(...a)=>r.uploadAudio&&r.uploadAudio(...a))},"Upload Audio")):p("",!0)])}const C=k(U,[["render",E]]);export{C as A};
