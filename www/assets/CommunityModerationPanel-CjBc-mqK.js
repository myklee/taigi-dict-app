import{b as r,c as A,A as so,w as no,f as d,g as l,t as s,k as f,v as y,l as u,L as V,F as q,D as O,y as c,j as S,o as i,G as B}from"./vendor-C5FfeEaS.js";import{_ as ao,a as io}from"./index-CmUZZITA.js";import"./router-Cvbgimde.js";const ro={name:"CommunityModerationPanel",setup(){const v=io(),o=r(""),I=r("pending"),e=r("created_at"),h=r("desc"),D=r(""),j=r(""),m=r(1),M=r(20),a=r([]),t=r(null),g=r(!1),F=r(!1),T=r(!1),Q=r(!1),b=r(null),p=r(""),x=r(""),R=A(()=>v.moderationQueue),_=A(()=>v.loading),L=A(()=>v.error),P=A(()=>v.canModerate),U=A(()=>Math.ceil(R.value.length/M.value)),C=async()=>{const n={status:I.value==="all"?["pending","approved","rejected"]:[I.value],searchTerm:o.value.trim(),sortBy:e.value,sortOrder:h.value,dateFrom:D.value,dateTo:j.value,limit:M.value,offset:(m.value-1)*M.value};await v.fetchModerationQueue(n)},N=()=>{m.value=1,a.value=[],C()},W=()=>{t.value&&clearTimeout(t.value),t.value=setTimeout(()=>{N()},300)},Y=()=>{o.value="",N()},z=n=>{const k=a.value.indexOf(n);k>-1?a.value.splice(k,1):a.value.push(n)},E=()=>{a.value.length===R.value.length?a.value=[]:a.value=R.value.map(n=>n.id)},G=n=>{b.value=n,p.value="",g.value=!0},H=n=>{b.value=n,p.value="",F.value=!0},w=()=>{g.value=!1,F.value=!1,T.value=!1,Q.value=!1,b.value=null,p.value="",x.value=""},J=async()=>{if(!b.value)return;if((await v.approveDefinition(b.value.id,p.value.trim())).success){w();const k=a.value.indexOf(b.value.id);k>-1&&a.value.splice(k,1)}},K=async()=>{if(!b.value||!p.value.trim())return;if((await v.rejectDefinition(b.value.id,p.value.trim())).success){w();const k=a.value.indexOf(b.value.id);k>-1&&a.value.splice(k,1)}},X=async()=>{if(a.value.length===0)return;(await v.bulkApproveDefinitions(a.value,x.value.trim())).success&&(a.value=[],w())},Z=async()=>{if(a.value.length===0||!x.value.trim())return;(await v.bulkRejectDefinitions(a.value,x.value.trim())).success&&(a.value=[],w())},$=()=>{m.value>1&&(m.value--,C())},oo=()=>{m.value<U.value&&(m.value++,C())},eo=n=>{console.log("View details for:",n)},lo=n=>new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),to=n=>n>0?"positive":n<0?"negative":"neutral";return so(()=>{P.value&&C()}),no(P,n=>{n&&C()}),{searchTerm:o,statusFilter:I,sortBy:e,sortOrder:h,dateFrom:D,dateTo:j,currentPage:m,selectedItems:a,showApproveModal:g,showRejectModal:F,showBulkApproveModal:T,showBulkRejectModal:Q,selectedItem:b,moderatorNotes:p,bulkModerationNotes:x,moderationQueue:R,loading:_,error:L,canModerate:P,totalPages:U,fetchQueue:C,applyFilters:N,debouncedSearch:W,clearSearch:Y,toggleSelection:z,selectAll:E,openApproveModal:G,openRejectModal:H,closeModals:w,approveItem:J,rejectItem:K,bulkApprove:X,bulkReject:Z,previousPage:$,nextPage:oo,viewDetails:eo,formatDate:lo,getVoteScoreClass:to}}},uo={class:"moderation-panel"},co={class:"panel-header"},vo={class:"header-stats"},mo={class:"stat-item"},go={class:"stat-number"},bo={class:"stat-item"},fo={class:"stat-number"},ko={class:"filters-section"},po={class:"search-bar"},yo={class:"filter-controls"},Mo={key:0,class:"bulk-actions"},Co={class:"bulk-actions-left"},jo={class:"selection-count"},xo={class:"bulk-actions-right"},wo=["disabled"],Ao=["disabled"],Io={key:1,class:"loading-state"},Ro={key:2,class:"error-state"},So={class:"error-message"},ho={key:3,class:"empty-state"},Do={key:4,class:"queue-list"},Fo={class:"item-header"},Po={class:"item-header-left"},No=["checked","onChange"],Vo={class:"item-meta"},Bo={class:"word-id"},To={class:"item-header-right"},Qo={class:"author-info"},Uo={class:"reputation"},qo={class:"submission-date"},Oo={class:"item-content"},_o={class:"definition-text"},Lo={key:0,class:"usage-example"},Wo={key:1,class:"context"},Yo={key:2,class:"tags"},zo={key:3,class:"moderator-notes"},Eo={class:"item-actions"},Go=["onClick","disabled"],Ho=["onClick","disabled"],Jo=["onClick"],Ko={key:5,class:"pagination"},Xo=["disabled"],Zo={class:"page-info"},$o=["disabled"],oe={class:"modal-header"},ee={class:"modal-body"},le={class:"form-group"},te={class:"modal-actions"},se=["disabled"],ne={class:"modal-header"},ae={class:"modal-body"},de={class:"form-group"},ie={class:"modal-actions"},re=["disabled"],ue={class:"modal-header"},ce={class:"modal-body"},ve={class:"form-group"},me={class:"modal-actions"},ge=["disabled"],be={class:"modal-header"},fe={class:"modal-body"},ke={class:"form-group"},pe={class:"modal-actions"},ye=["disabled"];function Me(v,o,I,e,h,D){var j,m,M,a;return i(),d("div",uo,[l("div",co,[o[45]||(o[45]=l("h2",{class:"panel-title"},"Community Moderation",-1)),l("div",vo,[l("span",mo,[l("span",go,s(e.moderationQueue.length),1),o[43]||(o[43]=l("span",{class:"stat-label"},"Pending",-1))]),l("span",bo,[l("span",fo,s(e.selectedItems.length),1),o[44]||(o[44]=l("span",{class:"stat-label"},"Selected",-1))])])]),l("div",ko,[l("div",po,[f(l("input",{"onUpdate:modelValue":o[0]||(o[0]=t=>e.searchTerm=t),type:"text",placeholder:"Search definitions, words, or authors...",class:"search-input",onInput:o[1]||(o[1]=(...t)=>e.debouncedSearch&&e.debouncedSearch(...t))},null,544),[[y,e.searchTerm]]),e.searchTerm?(i(),d("button",{key:0,onClick:o[2]||(o[2]=(...t)=>e.clearSearch&&e.clearSearch(...t)),class:"clear-search-btn"}," × ")):u("",!0)]),l("div",yo,[f(l("select",{"onUpdate:modelValue":o[3]||(o[3]=t=>e.statusFilter=t),onChange:o[4]||(o[4]=(...t)=>e.applyFilters&&e.applyFilters(...t)),class:"filter-select"},o[46]||(o[46]=[l("option",{value:"pending"},"Pending",-1),l("option",{value:"approved"},"Approved",-1),l("option",{value:"rejected"},"Rejected",-1),l("option",{value:"all"},"All Status",-1)]),544),[[V,e.statusFilter]]),f(l("select",{"onUpdate:modelValue":o[5]||(o[5]=t=>e.sortBy=t),onChange:o[6]||(o[6]=(...t)=>e.applyFilters&&e.applyFilters(...t)),class:"filter-select"},o[47]||(o[47]=[l("option",{value:"created_at"},"Date Submitted",-1),l("option",{value:"vote_score"},"Vote Score",-1),l("option",{value:"username"},"Author",-1),l("option",{value:"word_id"},"Word",-1)]),544),[[V,e.sortBy]]),f(l("select",{"onUpdate:modelValue":o[7]||(o[7]=t=>e.sortOrder=t),onChange:o[8]||(o[8]=(...t)=>e.applyFilters&&e.applyFilters(...t)),class:"filter-select"},o[48]||(o[48]=[l("option",{value:"desc"},"Newest First",-1),l("option",{value:"asc"},"Oldest First",-1)]),544),[[V,e.sortOrder]]),f(l("input",{"onUpdate:modelValue":o[9]||(o[9]=t=>e.dateFrom=t),type:"date",class:"date-input",onChange:o[10]||(o[10]=(...t)=>e.applyFilters&&e.applyFilters(...t)),placeholder:"From date"},null,544),[[y,e.dateFrom]]),f(l("input",{"onUpdate:modelValue":o[11]||(o[11]=t=>e.dateTo=t),type:"date",class:"date-input",onChange:o[12]||(o[12]=(...t)=>e.applyFilters&&e.applyFilters(...t)),placeholder:"To date"},null,544),[[y,e.dateTo]])])]),e.selectedItems.length>0?(i(),d("div",Mo,[l("div",Co,[l("button",{onClick:o[13]||(o[13]=(...t)=>e.selectAll&&e.selectAll(...t)),class:"bulk-btn secondary"},s(e.selectedItems.length===e.moderationQueue.length?"Deselect All":"Select All"),1),l("span",jo,s(e.selectedItems.length)+" item(s) selected",1)]),l("div",xo,[l("button",{onClick:o[14]||(o[14]=t=>e.showBulkApproveModal=!0),class:"bulk-btn approve",disabled:e.loading}," Bulk Approve ("+s(e.selectedItems.length)+") ",9,wo),l("button",{onClick:o[15]||(o[15]=t=>e.showBulkRejectModal=!0),class:"bulk-btn reject",disabled:e.loading}," Bulk Reject ("+s(e.selectedItems.length)+") ",9,Ao)])])):u("",!0),e.loading?(i(),d("div",Io,o[49]||(o[49]=[l("div",{class:"loading-spinner"},null,-1),l("p",null,"Loading moderation queue...",-1)]))):u("",!0),e.error?(i(),d("div",Ro,[l("p",So,s(e.error),1),l("button",{onClick:o[16]||(o[16]=(...t)=>e.fetchQueue&&e.fetchQueue(...t)),class:"retry-btn"},"Retry")])):u("",!0),!e.loading&&!e.error&&e.moderationQueue.length===0?(i(),d("div",ho,o[50]||(o[50]=[l("div",{class:"empty-icon"},"📝",-1),l("h3",null,"No items in moderation queue",-1),l("p",null,"All submissions have been reviewed or no submissions match your filters.",-1)]))):u("",!0),!e.loading&&!e.error&&e.moderationQueue.length>0?(i(),d("div",Do,[(i(!0),d(q,null,O(e.moderationQueue,t=>(i(),d("div",{key:t.id,class:B(["queue-item",{selected:e.selectedItems.includes(t.id)}])},[l("div",Fo,[l("div",Po,[l("input",{type:"checkbox",checked:e.selectedItems.includes(t.id),onChange:g=>e.toggleSelection(t.id),class:"item-checkbox"},null,40,No),l("div",Vo,[l("span",Bo,s(t.word_id),1),l("span",{class:B(["status-badge",t.status])},s(t.status),3),l("span",{class:B(["vote-score",e.getVoteScoreClass(t.voteScore)])},s(t.voteScore>=0?"+":"")+s(t.voteScore),3)])]),l("div",To,[l("span",Qo,[c(" by "+s(t.username)+" ",1),l("span",Uo,"("+s(t.authorReputation)+" rep)",1)]),l("span",qo,s(e.formatDate(t.createdAt)),1)])]),l("div",Oo,[l("div",_o,[o[51]||(o[51]=l("strong",null,"Definition:",-1)),c(" "+s(t.definition),1)]),t.usage_example?(i(),d("div",Lo,[o[52]||(o[52]=l("strong",null,"Usage:",-1)),c(" "+s(t.usage_example),1)])):u("",!0),t.context?(i(),d("div",Wo,[o[53]||(o[53]=l("strong",null,"Context:",-1)),c(" "+s(t.context),1)])):u("",!0),t.tags&&t.tags.length>0?(i(),d("div",Yo,[o[54]||(o[54]=l("strong",null,"Tags:",-1)),(i(!0),d(q,null,O(t.tags,g=>(i(),d("span",{key:g,class:"tag"},s(g),1))),128))])):u("",!0),t.moderator_notes?(i(),d("div",zo,[o[55]||(o[55]=l("strong",null,"Moderator Notes:",-1)),c(" "+s(t.moderator_notes),1)])):u("",!0)]),l("div",Eo,[l("button",{onClick:g=>e.openApproveModal(t),class:"action-btn approve",disabled:e.loading}," Approve ",8,Go),l("button",{onClick:g=>e.openRejectModal(t),class:"action-btn reject",disabled:e.loading}," Reject ",8,Ho),l("button",{onClick:g=>e.viewDetails(t),class:"action-btn secondary"}," View Details ",8,Jo)])],2))),128))])):u("",!0),e.moderationQueue.length>0?(i(),d("div",Ko,[l("button",{onClick:o[17]||(o[17]=(...t)=>e.previousPage&&e.previousPage(...t)),disabled:e.currentPage===1||e.loading,class:"page-btn"}," Previous ",8,Xo),l("span",Zo," Page "+s(e.currentPage)+" of "+s(e.totalPages),1),l("button",{onClick:o[18]||(o[18]=(...t)=>e.nextPage&&e.nextPage(...t)),disabled:e.currentPage===e.totalPages||e.loading,class:"page-btn"}," Next ",8,$o)])):u("",!0),e.showApproveModal?(i(),d("div",{key:6,class:"modal-overlay",onClick:o[24]||(o[24]=(...t)=>e.closeModals&&e.closeModals(...t))},[l("div",{class:"modal",onClick:o[23]||(o[23]=S(()=>{},["stop"]))},[l("div",oe,[o[56]||(o[56]=l("h3",null,"Approve Definition",-1)),l("button",{onClick:o[19]||(o[19]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-close"},"×")]),l("div",ee,[l("p",null,[o[57]||(o[57]=l("strong",null,"Word:",-1)),c(" "+s((j=e.selectedItem)==null?void 0:j.word_id),1)]),l("p",null,[o[58]||(o[58]=l("strong",null,"Definition:",-1)),c(" "+s((m=e.selectedItem)==null?void 0:m.definition),1)]),l("div",le,[o[59]||(o[59]=l("label",{for:"approve-notes"},"Moderator Notes (optional):",-1)),f(l("textarea",{id:"approve-notes","onUpdate:modelValue":o[20]||(o[20]=t=>e.moderatorNotes=t),placeholder:"Add any notes about this approval...",class:"notes-textarea"},null,512),[[y,e.moderatorNotes]])])]),l("div",te,[l("button",{onClick:o[21]||(o[21]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-btn secondary"},"Cancel"),l("button",{onClick:o[22]||(o[22]=(...t)=>e.approveItem&&e.approveItem(...t)),class:"modal-btn approve",disabled:e.loading},s(e.loading?"Approving...":"Approve"),9,se)])])])):u("",!0),e.showRejectModal?(i(),d("div",{key:7,class:"modal-overlay",onClick:o[30]||(o[30]=(...t)=>e.closeModals&&e.closeModals(...t))},[l("div",{class:"modal",onClick:o[29]||(o[29]=S(()=>{},["stop"]))},[l("div",ne,[o[60]||(o[60]=l("h3",null,"Reject Definition",-1)),l("button",{onClick:o[25]||(o[25]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-close"},"×")]),l("div",ae,[l("p",null,[o[61]||(o[61]=l("strong",null,"Word:",-1)),c(" "+s((M=e.selectedItem)==null?void 0:M.word_id),1)]),l("p",null,[o[62]||(o[62]=l("strong",null,"Definition:",-1)),c(" "+s((a=e.selectedItem)==null?void 0:a.definition),1)]),l("div",de,[o[63]||(o[63]=l("label",{for:"reject-notes"},"Reason for Rejection (required):",-1)),f(l("textarea",{id:"reject-notes","onUpdate:modelValue":o[26]||(o[26]=t=>e.moderatorNotes=t),placeholder:"Please provide a reason for rejecting this definition...",class:"notes-textarea",required:""},null,512),[[y,e.moderatorNotes]])])]),l("div",ie,[l("button",{onClick:o[27]||(o[27]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-btn secondary"},"Cancel"),l("button",{onClick:o[28]||(o[28]=(...t)=>e.rejectItem&&e.rejectItem(...t)),class:"modal-btn reject",disabled:e.loading||!e.moderatorNotes.trim()},s(e.loading?"Rejecting...":"Reject"),9,re)])])])):u("",!0),e.showBulkApproveModal?(i(),d("div",{key:8,class:"modal-overlay",onClick:o[36]||(o[36]=(...t)=>e.closeModals&&e.closeModals(...t))},[l("div",{class:"modal",onClick:o[35]||(o[35]=S(()=>{},["stop"]))},[l("div",ue,[o[64]||(o[64]=l("h3",null,"Bulk Approve Definitions",-1)),l("button",{onClick:o[31]||(o[31]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-close"},"×")]),l("div",ce,[l("p",null,[o[65]||(o[65]=c("You are about to approve ")),l("strong",null,s(e.selectedItems.length),1),o[66]||(o[66]=c(" definitions."))]),l("div",ve,[o[67]||(o[67]=l("label",{for:"bulk-approve-notes"},"Moderator Notes (optional):",-1)),f(l("textarea",{id:"bulk-approve-notes","onUpdate:modelValue":o[32]||(o[32]=t=>e.bulkModerationNotes=t),placeholder:"Add notes for all approved items...",class:"notes-textarea"},null,512),[[y,e.bulkModerationNotes]])])]),l("div",me,[l("button",{onClick:o[33]||(o[33]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-btn secondary"},"Cancel"),l("button",{onClick:o[34]||(o[34]=(...t)=>e.bulkApprove&&e.bulkApprove(...t)),class:"modal-btn approve",disabled:e.loading},s(e.loading?"Approving...":`Approve ${e.selectedItems.length} Items`),9,ge)])])])):u("",!0),e.showBulkRejectModal?(i(),d("div",{key:9,class:"modal-overlay",onClick:o[42]||(o[42]=(...t)=>e.closeModals&&e.closeModals(...t))},[l("div",{class:"modal",onClick:o[41]||(o[41]=S(()=>{},["stop"]))},[l("div",be,[o[68]||(o[68]=l("h3",null,"Bulk Reject Definitions",-1)),l("button",{onClick:o[37]||(o[37]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-close"},"×")]),l("div",fe,[l("p",null,[o[69]||(o[69]=c("You are about to reject ")),l("strong",null,s(e.selectedItems.length),1),o[70]||(o[70]=c(" definitions."))]),l("div",ke,[o[71]||(o[71]=l("label",{for:"bulk-reject-notes"},"Reason for Rejection (required):",-1)),f(l("textarea",{id:"bulk-reject-notes","onUpdate:modelValue":o[38]||(o[38]=t=>e.bulkModerationNotes=t),placeholder:"Please provide a reason for rejecting these definitions...",class:"notes-textarea",required:""},null,512),[[y,e.bulkModerationNotes]])])]),l("div",pe,[l("button",{onClick:o[39]||(o[39]=(...t)=>e.closeModals&&e.closeModals(...t)),class:"modal-btn secondary"},"Cancel"),l("button",{onClick:o[40]||(o[40]=(...t)=>e.bulkReject&&e.bulkReject(...t)),class:"modal-btn reject",disabled:e.loading||!e.bulkModerationNotes.trim()},s(e.loading?"Rejecting...":`Reject ${e.selectedItems.length} Items`),9,ye)])])])):u("",!0)])}const we=ao(ro,[["render",Me],["__scopeId","data-v-c0a8fab4"]]);export{we as default};
